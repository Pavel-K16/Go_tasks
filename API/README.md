# Документация к программе main.go 
### Data Base
Данный сервис взаимодействует с базой данных `postgres`. Для начала работы необходимо создать базу данных или использовать установленную по умолчанию. Далее в текущей базе данных необходимо создать две таблицы (сущности), которые соотвествуют условию данного задания. 
#### !!!!!!
#### Таблица содержащая информацию о товарах должна строго называться `product`, а таблица содержащаю информацию о категориях товаров должна строго называться `productcategory`.
#### !!!!!!
### DSN
Чтобы подключиться к созданной БД необходимо использовать строку подключения `dsn`. 

Для создания `dsn` необходимо прейти в папку `env`, лежащую в проекте, а затем зайти в файл `dsn.env`:  
```
API/env/dsn.env 
```     
Файл `dsn.env` выглядит следующим образом:
```
SERV=":8080"

HOST="localhost"

USER="pavel"

PASS="55544"

DBNAME="shop"

PORT="5432"

SSL="disable"
```
- `SERV` -- порт, на котором будет запускаться и работать сервис. 
- `HOST` -- `IP` адрес вашего сервера, на котором будет "подниматься" данный сервис. В случае выше `localhost` идетифицирует адрес вашей локальной машины. То есть Ваш же компьютер и сервер, и клиент.  
- `USER` -- имя пользователя, с которого Вы подключаетесь к БД. 
- `PASS` -- пароль для подключения к БД.
- `DBNAME` -- имя БД, к которой Вы хотите подключиться.
- `PORT` -- порт, на котором будет работать БД `postgres`.
- `SSL` -- тип подключения к БД.

Выше приведён пример содержания файла `dsn.env` для подключения к БД с моими параметрами. У Вас эти параметры могут быть другими.

#### Для корректной работы программы важно верно заполнить файл `dsn.env` правильными для подключения параметрами. Иначе программа `main.go` выдаст ошибку при подключении к БД и завершит исполнение. 

## Использование API

Данный сервис реализует `GET`, `POST`, `PUT`, `DELETE` запросы. `GET` запрос можно реализовать либо с помощью терминала через `curl` параметры, либо через строку запроса в браузере, остальные запросы только через `curl` параметры. Далее будут показаны возможные запросы, используя данные `dsn` выше. 

#### Данное API реализует следующие `GET` запросы:

- `http://localhost:8080/item/{id}` -- получение информации о продукте из таблицы `product`, где `{id}` -- уникальный номер продукта. Идентичный запрос через curl параметры с использованием терминала `curl http://localhost:8080/item/{id}`. 
-  `http://localhost:8080/category` -- получение информации о всех категориях продуктов из таблицы `productсategory`.
-  `http://localhost:8080/item` -- получение информации о всех продуктах из таблицы `product`.

#### `POST` запросы:
Напомним, что `PUT` и `POST` запросы осуществляются с помощью `curl` параметров через терминал.
- `curl -X POST -H "Content-Type: application/json" -d '{"Name":"Iphone 6","Description":"Mobile phone", "Price":25000,"categoryid":1}' http://localhost:8080/item` -- данный запрос используется для создания записи в таблице `product`. Важно учесть, что поле `"categoryid"` должно быть не пустым и содержать значение, по которому можно найти запись в таблице `productcategory`. Иначе программа выдаст ошибку. В качестве тела запроса передаётся `json` файл, пример его заполнения представлен в запросе. Также поле `name` должно содержать непустое значение. 
- `curl -X POST -H "Content-Type: application/json" -d '{"Name":"Phones", "Description":"The best phones"}' http://localhost:8080/category` -- данный запрос используется для создания записи в таблице `productcategory`. Поле `name` также должно быть ненулевым.
#### `PUT` запросы:
- `curl -X PUT -H "Content-Type: application/json" -d '{"Name":"Iphone 16", "description":"Очень хороший телефон", "Price": 96500,"categoryid":1}' http://localhost:8080/item/{id}` -- данный запрос используется для обновление записи в таблице `product`, где `{id}` -- уникальный номер записи. Для корректной работы запись под данным номером должная существовать. Если оставить одно из полей `json` файла пустым, то это поле в записи не будет обновлено.
- `curl -X PUT -H "Content-Type: application/json" -d '{"Name":"Дорогие телефоны", "description":"В этой категории телефоны дороже 100к"}' http://localhost:8080/category/{id}` -- аналогичный запрос для создания записи в таблице `productcategory`.
#### `DELETE` запросы:
- `curl -X DELETE http://localhost:8080/item/{id}` -- данный запрос удаляет запись из таблицы `product`, где `{id}` -- заданный номер записи.
- `curl -X DELETE http://localhost:8080/category/{id}` -- аналогичный запрос для таблицы `productcategory`. 

### Краткая сводка запросов
#### `GET:`
- `http://localhost:8080/item/{id}`
- `curl http://localhost:8080/item/{id}`
- `http://localhost:8080/category`
- `curl http://localhost:8080/category`
- `http://localhost:8080/item`
- `curl http://localhost:8080/item`
#### `POST:`
- `curl -X POST -H "Content-Type: application/json" -d '{"Name":"Iphone 6","Description":"Mobile phone", "Price":25000,"categoryid":1}' http://localhost:8080/item`
- `curl -X POST -H "Content-Type: application/json" -d '{"Name":"Phones", "Description":"The best phones"}' http://localhost:8080/category`
#### `PUT:`
- `curl -X PUT -H "Content-Type: application/json" -d '{"Name":"Iphone 16", "description":"Очень хороший телефон", "Price": 96500,"categoryid":1}' http://localhost:8080/item/{id}`
- `curl -X PUT -H "Content-Type: application/json" -d '{"Name":"Дорогие телефоны", "description":"В этой категории телефоны дороже 100к"}' http://localhost:8080/category/{id}`
#### `DELETE:`
- `curl -X DELETE http://localhost:8080/item/{id}`
- `curl -X DELETE http://localhost:8080/category/{id}`
#### Для запуска программы перейдите в папку API. Команда запуска: go run main.go
### Dockerfile 
#### Хотел завернуть весь сервис в докер файл, но не хватило времени. Займусь этим позже. 